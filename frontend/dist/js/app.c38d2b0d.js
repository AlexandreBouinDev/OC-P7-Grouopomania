(function(){"use strict";var e={5178:function(e,t,o){var s=o(9963),n=o(6252);function i(e,t){const o=(0,n.up)("router-view");return(0,n.wg)(),(0,n.j4)(o)}var r=o(3744);const a={},l=(0,r.Z)(a,[["render",i]]);var c=l,d=o(2119);const u={class:"page-body"};function m(e,t,o,s,i,r){const a=(0,n.up)("NavBar"),l=(0,n.up)("PostsList");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(a),(0,n._)("div",u,[(0,n.Wm)(l)])],64)}var p=o.p+"img/icon-left-font-monochrome-white.6cb8d331.png";const h={id:"navbar"},g={class:"left"},f=(0,n._)("img",{src:p,height:"30"},null,-1),v={class:"right"},w=(0,n.Uk)("Fil d'actualité "),P=(0,n.Uk)("Mon profil "),I=(0,n.Uk)("Déconnexion ");function y(e,t,o,s,i,r){const a=(0,n.up)("router-link"),l=(0,n.up)("homeIcon"),c=(0,n.up)("accountIcon"),d=(0,n.up)("powerIcon");return(0,n.wg)(),(0,n.iD)("nav",h,[(0,n._)("div",g,[(0,n.Wm)(a,{to:"/home"},{default:(0,n.w5)((()=>[f])),_:1})]),(0,n._)("div",v,[(0,n.Wm)(a,{to:"/home"},{default:(0,n.w5)((()=>[w,(0,n.Wm)(l)])),_:1}),(0,n.Wm)(a,{to:/profile/+this.localUser},{default:(0,n.w5)((()=>[P,(0,n.Wm)(c)])),_:1},8,["to"]),(0,n.Wm)(a,{to:"/login",onClick:t[0]||(t[0]=e=>r.logout())},{default:(0,n.w5)((()=>[I,(0,n.Wm)(d)])),_:1})])])}var C=o(5716),_=o(4017),k=o(4821),b={components:{homeIcon:C.Z,accountIcon:_.Z,powerIcon:k.Z},data(){return{localUser:localStorage.getItem("userId")}},methods:{logout(){localStorage.clear()}}};const D=(0,r.Z)(b,[["render",y]]);var U=D;const S={class:"comment-section"};function x(e,t,o,s,i,r){const a=(0,n.up)("NewPost"),l=(0,n.up)("PostComponent"),c=(0,n.up)("CommentsList");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(a,{onNewPost:t[0]||(t[0]=e=>r.updateList())}),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.xPosts,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.id,class:"post",id:"PostsList"},[(0,n.Wm)(l,{post:e,onRefreshPost:r.updateList},null,8,["post","onRefreshPost"]),(0,n._)("div",S,[(0,n.Wm)(c,{postId:e.id,onRefreshPost:r.updateList},null,8,["postId","onRefreshPost"])])])))),128))],64)}const $=(0,n._)("h3",null,"Écrire un nouveau post",-1),j=(0,n._)("input",{type:"text",placeholder:"Titre",name:"title",class:"newpost-input title"},null,-1),L=(0,n._)("textarea",{type:"textarea",placeholder:"Message...",name:"content",class:"newpost-input message"},null,-1),N={class:"newpost-actions"},M={for:"file-input",class:"uploadPostImage"},O=(0,n.Uk)(" Ajouter une image"),A=(0,n._)("button",{type:"submit",class:"newpost-submit"},"Envoyer",-1);function E(e,t,o,s,i,r){const a=(0,n.up)("postIcon"),l=(0,n.up)("addImgIcon");return(0,n.wg)(),(0,n.iD)("form",{onSubmit:t[1]||(t[1]=e=>r.submitPost(e)),class:"newpost"},[(0,n._)("span",null,[(0,n.Wm)(a,{size:20}),$]),j,L,(0,n._)("div",N,[(0,n._)("input",{type:"file",class:"uploadPostImage input",id:"file-input",accept:"image/*",onChange:t[0]||(t[0]=t=>e.uploadPostImage(t)),name:"file-input"},null,32),(0,n._)("label",M,[(0,n.Wm)(l,{size:20}),O]),A])],32)}const T="http://localhost:3000";class W{getUsers(){return fetch(`${T}/api/users`).then((e=>e.json())).then((e=>e)).catch(console.error)}getUserData(e){return fetch(`${T}/api/users/`+e).then((e=>e.json())).then((e=>e)).catch(console.error)}addUser(e){let t=JSON.stringify(e);return fetch(`${T}/api/users/signup`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:t}).then((e=>e.json())).then((e=>e)).catch(console.error)}login(e){let t=JSON.stringify(e);return fetch(`${T}/api/users/login`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:t}).then((e=>e.json())).then((e=>(localStorage.setItem("token",e.token),localStorage.setItem("userId",e.userId),localStorage.setItem("isAdmin",e.isAdmin),e))).catch(console.error)}editProfile(e){let t=localStorage.getItem("token"),o=JSON.stringify(e);return fetch(`${T}/api/users/edit`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t}`},body:o}).then((e=>e.json())).then((e=>e)).catch(console.error)}updateProfilePicture(e,t){let o=localStorage.getItem("token"),s=new FormData;return s.append("image",e),fetch(`${T}/api/users/updateProfilePicture/`+t,{method:"POST",headers:{Authorization:`Bearer ${o}`},body:s}).then((e=>e.json())).then((e=>e)).catch(console.error)}deleteProfile(e){let t=localStorage.getItem("token"),o=JSON.stringify(e);return fetch(`${T}/api/users/delete`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t}`},body:o}).catch(console.error)}getPosts(){return fetch(`${T}/api/posts`).then((e=>e.json())).then((e=>e)).catch(console.error)}getUserPosts(e){return fetch(`${T}/api/posts/`+e).then((e=>e.json())).then((e=>e)).catch(console.error)}addPost(e){let t=localStorage.getItem("token");return fetch(`${T}/api/posts`,{method:"POST",headers:{Authorization:`Bearer ${t}`},body:e}).then((e=>e.json())).then((e=>e)).catch(console.error)}editPost(e){let t=localStorage.getItem("token"),o=JSON.stringify(e);return fetch(`${T}/api/posts`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t}`},body:o}).then((e=>e.json())).then((e=>e)).catch(console.error)}deletePost(e){let t=localStorage.getItem("token"),o={id:e},s=JSON.stringify(o);return fetch(`${T}/api/posts`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t}`},body:s}).catch(console.error)}likePost(e){let t=localStorage.getItem("token"),o=JSON.stringify(e);return fetch(`${T}/api/posts/like`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t}`},body:o}).catch(console.error)}getUserLikes(e){return fetch(`${T}/api/posts/like/`+e).then((e=>e.json())).then((e=>e)).catch(console.error)}getComments(e){return fetch(`${T}/api/comments/`+e).then((e=>e.json())).then((e=>e)).catch(console.error)}addComment(e){let t=localStorage.getItem("token"),o=JSON.stringify(e);return fetch(`${T}/api/comments`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t}`},body:o}).then((e=>e.json())).then((e=>e)).catch(console.error)}editComment(e){let t=localStorage.getItem("token"),o=e.id,s=JSON.stringify(e);return fetch(`${T}/api/comments/`+o,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t}`},body:s}).then((e=>e.json())).then((e=>e)).catch(console.error)}deleteComment(e){let t=localStorage.getItem("token"),o={id:e},s=JSON.stringify(o);return fetch(`${T}/api/comments`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${t}`},body:s}).catch(console.error)}}let Z=new W;class z{async getPosts(){let e=await Z.getPosts();return e}async getUserLikes(e){let t=await Z.getUserLikes(e);return t}async getUserPosts(e){let t=await Z.getUserPosts(e);return t}async getUsers(){let e=await Z.getUsers();return e}async getUserData(e){let t=await Z.getUserData(e);return t}async getComments(e){let t=await Z.getComments(e);return t}addUser(e){Z.addUser(e)}async login(e){return Z.login(e).then((e=>e))}editProfile(e){return Z.editProfile(e)}updateProfilePicture(e,t){return Z.updateProfilePicture(e,t)}deleteProfile(e){return Z.deleteProfile(e)}async addPost(e,t){let o=localStorage.getItem("userId");e.userId=o;const s=new FormData;s.append("postReq",JSON.stringify(e)),s.append("image",t),await Z.addPost(s)}editPost(e){e={...e},Z.editPost(e).then((e=>e))}deletePost(e){Z.deletePost(e)}likePost(e){Z.likePost(e)}async addComment(e){let t=localStorage.getItem("userId");e.userId=t,await Z.addComment(e)}editComment(e){e={...e,userId:3},Z.editComment(e)}deleteComment(e){Z.deleteComment(e)}}var B=o(7883),F=o(8570);let q=new z;var R={components:{postIcon:B.Z,addImgIcon:F.Z},methods:{async submitPost(e){e.preventDefault();const t=new FormData(e.target),o={title:t.get("title"),content:t.get("content")},s=t.get("file-input");await q.addPost(o,s),this.$emit("new-post")}}};const J=(0,r.Z)(R,[["render",E]]);var H=J,Y=o(3577);const K={class:"post-content"},V={class:"post-title"},X={class:"post-header"},G=["href"],Q={class:"post-user"},ee={class:"post-date"},te=["href"],oe=["src"],se={class:"edit-fields"},ne=["value"],ie=["value"],re={class:"edit-action",type:"submit"},ae=["src"];function le(e,t,o,s,i,r){const a=(0,n.up)("edit-icon"),l=(0,n.up)("deleteIcon"),c=(0,n.up)("send-icon"),d=(0,n.up)("LikeButton");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",K,[(0,n._)("div",{class:(0,Y.C_)(["post-metadata",i.editMode])},[(0,n._)("div",V,[(0,n._)("h2",null,(0,Y.zw)(this.post.title),1),this.localUser==this.post.userId?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,Y.C_)(["post-actions",i.editMode])},[(0,n.Wm)(a,{onClick:t[0]||(t[0]=e=>r.editPost())}),(0,n.Wm)(l,{onClick:t[1]||(t[1]=e=>r.deletePost(o.post.id))})],2)):(0,n.kq)("",!0)]),(0,n._)("div",X,[(0,n._)("a",{href:/profile/+this.post.userId},[(0,n._)("h3",Q,(0,Y.zw)(r.getUserData(this.post.userId).name),1)],8,G),(0,n._)("p",ee,(0,Y.zw)(r.formatDate(this.post.creationDate)),1)]),(0,n._)("a",{href:/profile/+this.post.userId},[(0,n._)("img",{src:r.setAvatarPath(r.getUserData(this.post.userId).avatar),className:"post-avatar"},null,8,oe)],8,te)],2),(0,n._)("p",{class:(0,Y.C_)(["post-message",i.editMode])},(0,Y.zw)(this.post.content),3),(0,n._)("form",{class:(0,Y.C_)([i.editMode,"edit-form"]),onSubmit:t[2]||(t[2]=e=>r.sendEditedPost(e))},[(0,n._)("div",se,[(0,n._)("input",{type:"text",value:o.post.title,name:"title"},null,8,ne),(0,n._)("textarea",{type:"text",value:o.post.content,name:"content"},null,8,ie)]),(0,n._)("button",re,[(0,n.Wm)(c)])],34),this.post.img?((0,n.wg)(),(0,n.iD)("img",{key:0,src:r.setImagePath(this.post.img),className:"post-image"},null,8,ae)):(0,n.kq)("",!0)]),(0,n.Wm)(d,{userId:this.localUser,postId:this.post.id,isLiked:this.post.isLiked,onNewLike:r.refreshPost},null,8,["userId","postId","isLiked","onNewLike"])],64)}const ce=(0,n.Uk)("J'aime ");function de(e,t,o,s,i,r){const a=(0,n.up)("likeIcon");return(0,n.wg)(),(0,n.iD)("div",{class:(0,Y.C_)(["likebutton",{isLiked:o.isLiked}]),onClick:t[0]||(t[0]=(...e)=>r.handleLike&&r.handleLike(...e))},[(0,n.Wm)(a),ce],2)}var ue=o(5316);let me=new z;var pe={data(){return{likedClass:""}},props:{userId:Number,postId:Number,isLiked:Boolean},components:{likeIcon:ue.Z},mounted(){this.isLiked?this.likedClass="liked":this.likedClass=""},methods:{handleLike(){let e={userId:parseInt(this.userId),postId:this.postId};me.likePost(e),this.$emit("new-like")}}};const he=(0,r.Z)(pe,[["render",de]]);var ge=he,fe=o(8171),ve=o(3599),we=o(3750);let Pe=new z;var Ie={components:{LikeButton:ge,editIcon:fe.Z,deleteIcon:ve.Z,sendIcon:we.Z},data(){return{path:"http://localhost:3000",xUsers:[],editMode:"",localUser:localStorage.getItem("userId")}},props:{post:{title:String,content:String,userId:Number,creationDate:String,id:Number,img:String,isLiked:Boolean}},async mounted(){this.xUsers=await Pe.getUsers()},methods:{getUserData(e){let t=this.xUsers.find((t=>t.id===e)),o="",s="";return t?(o=`${t.firstname} ${t.lastname}`,s=t.avatar,{name:o,avatar:s}):"Anonymous"},formatDate(e){let t=e.slice(0,10);return t},editPost(){this.editMode="editMode"},deletePost(e){Pe.deletePost(e),this.$emit("refresh-post")},sendEditedPost(e){e.preventDefault();const t=new FormData(e.target),o={title:t.get("title"),content:t.get("content"),id:this.post.id,userId:this.userId};Pe.editPost(o),this.editMode="",this.$emit("refresh-post")},setAvatarPath(e){let t=`${this.path}/images/${e??"undefined.png"} `;return t},setImagePath(e){let t=`${this.path}/images/${e}`;return t},refreshPost(){this.$emit("refresh-post")}}};const ye=(0,r.Z)(Ie,[["render",le]]);var Ce=ye;function _e(e,t,o,s,i,r){const a=(0,n.up)("CommentComponent"),l=(0,n.up)("NewComment");return(0,n.wg)(),(0,n.iD)(n.HY,null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.xComments,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.id,class:"comments",id:"CommentsList"},[(0,n.Wm)(a,{comment:e},null,8,["comment"])])))),128)),(0,n.Wm)(l,{postId:o.postId,onNewComment:r.updateList},null,8,["postId","onNewComment"])],64)}const ke={class:"comment-content"},be={class:"comment-header"},De=["href"],Ue=["src"],Se=["href"],xe={class:"comment-user"},$e={class:"comment-date"},je=["value"],Le={type:"submit"};function Ne(e,t,o,s,i,r){const a=(0,n.up)("editIcon"),l=(0,n.up)("deleteIcon"),c=(0,n.up)("send-icon");return(0,n.wg)(),(0,n.iD)(n.HY,null,[this.localUser==o.comment.userId?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,Y.C_)(["comment-actions",i.editMode])},[(0,n.Wm)(a,{onClick:t[0]||(t[0]=e=>r.editComment())}),(0,n.Wm)(l,{onClick:t[1]||(t[1]=e=>r.deleteComment(o.comment.id))})],2)):(0,n.kq)("",!0),(0,n._)("div",ke,[(0,n._)("div",be,[(0,n._)("a",{href:/profile/+o.comment.userId},[(0,n._)("img",{src:r.setAvatarPath(r.getUserData(o.comment.userId).avatar),className:"comment-avatar"},null,8,Ue)],8,De),(0,n._)("div",null,[(0,n._)("a",{href:/profile/+o.comment.userId},[(0,n._)("h3",xe,(0,Y.zw)(r.getUserData(o.comment.userId).name),1)],8,Se),(0,n._)("p",$e,(0,Y.zw)(r.formatDate(o.comment.creationDate)),1)])]),(0,n._)("p",{class:(0,Y.C_)([i.editMode,"comment-message"])},(0,Y.zw)(o.comment.content),3),(0,n._)("form",{class:(0,Y.C_)([i.editMode,"edit-field"]),type:"submit",onSubmit:t[2]||(t[2]=e=>r.sendEditedComment(e))},[(0,n._)("textarea",{type:"text",value:o.comment.content,name:"content"},null,8,je),(0,n._)("button",Le,[(0,n.Wm)(c)])],34)])],64)}let Me=new z;var Oe={components:{editIcon:fe.Z,deleteIcon:ve.Z,sendIcon:we.Z},data(){return{path:"http://localhost:3000",xUsers:[],editMode:"",localUser:localStorage.getItem("userId")}},props:{comment:{content:String,userId:Number,creationDate:String,id:Number}},async mounted(){this.xUsers=await Me.getUsers()},methods:{getUserData(e){let t=this.xUsers.find((t=>t.id===e)),o="",s="";return t?(o=`${t.firstname} ${t.lastname}`,s=t.avatar,{name:o,avatar:s}):"Anonymous"},formatDate(e){let t=e.slice(0,10);return t},editComment(){this.editMode="editMode"},deleteComment(e){Me.deleteComment(e)},setAvatarPath(e){let t=`${this.path}/images/${e??"undefined.png"} `;return t},sendEditedComment(e){e.preventDefault();const t=new FormData(e.target),o={content:t.get("content"),id:this.comment.id};Me.editComment(o),this.editMode=""}}};const Ae=(0,r.Z)(Oe,[["render",Ne]]);var Ee=Ae;const Te=(0,n._)("textarea",{type:"textarea",placeholder:"Ajouter un commentaire...",name:"content",class:"newcomment-input message"},null,-1),We={type:"submit",class:"newcomment-submit"};function Ze(e,t,o,s,i,r){const a=(0,n.up)("sendIcon");return(0,n.wg)(),(0,n.iD)("form",{onSubmit:t[0]||(t[0]=e=>r.submitComment(e)),class:"newcomment"},[Te,(0,n._)("button",We,[(0,n.Wm)(a,{size:15})])],32)}let ze=new z;var Be={components:{sendIcon:we.Z},emits:["newComment"],props:{postId:Number},methods:{async submitComment(e){e.preventDefault();const t=new FormData(e.target),o={content:t.get("content"),postId:this.postId};await ze.addComment(o),this.$emit("new-comment"),this.$forceUpdate(),e.target.content.value=""}}};const Fe=(0,r.Z)(Be,[["render",Ze]]);var qe=Fe;let Re=new z;var Je={components:{CommentComponent:Ee,NewComment:qe},props:{postId:Number},data(){return{xComments:[],xUsers:[],length:0}},async mounted(){this.xComments=await Re.getComments(this.postId),this.xUsers=await Re.getUsers(),this.length=await this.xComments.length},methods:{getUserName(e){let t=this.xUsers.find((t=>t.id===e)),o="";return t?(o=`${t.firstname} ${t.lastname}`,o):"Anonymous"},formatDate(e){let t=e.slice(0,10);return t},async updateList(){this.xComments=await Re.getComments(this.postId),console.log(this.xComments),this.$emit("refresh-post")}}};const He=(0,r.Z)(Je,[["render",_e]]);var Ye=He;let Ke=new z;var Ve={components:{NewPost:H,PostComponent:Ce,CommentsList:Ye},data(){return{xPosts:[],xLikes:[]}},async mounted(){this.loadPost()},methods:{updateList(){this.loadPost()},async loadPost(){let e=localStorage.getItem("userId");this.xPosts=await Ke.getPosts(),this.xLikes=await Ke.getUserLikes(e),0!=this.xPosts.length&&0!=this.xLikes.length&&this.xPosts.forEach((e=>{this.xLikes.find((t=>t.postId===e.id))&&(e.isLiked=!0)}))}}};const Xe=(0,r.Z)(Ve,[["render",x]]);var Ge=Xe,Qe={components:{NavBar:U,PostsList:Ge},data(){return{shouldUpdate:!1}},methods:{updateList(){console.log("shouldUpdate à true"),this.shouldUpdate=!0}}};const et=(0,r.Z)(Qe,[["render",m]]);var tt=et;const ot={class:"login-body"},st=(0,n._)("div",{class:"login-title"},[(0,n._)("img",{src:p}),(0,n._)("h1",null,"Toujours plus proche de vous.")],-1),nt={class:"login-block"},it={class:"login-switch"},rt=(0,n._)("div",{class:"login-footer"},[(0,n._)("h5",null,"© Alexandre Bouin - 2022")],-1);function at(e,t,o,s,i,r){const a=(0,n.up)("LoginForm"),l=(0,n.up)("RegisterForm");return(0,n.wg)(),(0,n.iD)("div",ot,[st,(0,n._)("div",nt,[(0,n._)("div",it,[(0,n._)("button",{class:(0,Y.C_)([i.registerMode,"loginB"]),onClick:t[0]||(t[0]=e=>r.handleMode(!1))}," CONNEXION",2),(0,n._)("button",{class:(0,Y.C_)([i.registerMode,"signinB"]),onClick:t[1]||(t[1]=e=>r.handleMode(!0))}," INSCRIPTION ",2)]),(0,n.Wm)(a,{class:(0,Y.C_)(["loginF",i.registerMode]),email:this.email},null,8,["class","email"]),(0,n.Wm)(l,{class:(0,Y.C_)(["registerF",i.registerMode]),onNewUser:t[2]||(t[2]=e=>r.handleMode(!1,e))},null,8,["class"])]),rt])}const lt={class:"form-inputs"},ct=["value"],dt=(0,n._)("input",{type:"password",placeholder:"Mot de passe",name:"password",required:"",autocomplete:"on"},null,-1),ut=(0,n._)("button",{type:"submit"},"VALIDER",-1);function mt(e,t,o,s,i,r){return(0,n.wg)(),(0,n.iD)("form",{class:"login-form",onSubmit:t[0]||(t[0]=e=>r.submitLogin(e))},[(0,n._)("div",lt,[(0,n._)("input",{type:"text",placeholder:"E-mail",value:this.email,name:"email",required:"",autocomplete:"on"},null,8,ct),dt]),(0,n._)("p",{class:(0,Y.C_)(["errormsg",i.error])},"Email ou mot de passe erroné !",2),ut],32)}let pt=new z;var ht={data(){return{error:""}},props:{email:String},methods:{async submitLogin(e){e.preventDefault();const t=new FormData(e.target),o={email:t.get("email"),password:t.get("password")};pt.login(o).then((e=>{e.token?ho.push("/home"):this.error="getError"}))}}};const gt=(0,r.Z)(ht,[["render",mt]]);var ft=gt;const vt=(0,n.uE)('<div class="form-inputs"><input type="email" placeholder="E-mail" name="email" required><input type="password" placeholder="Mot de passe" name="password" required><input type="text" placeholder="Nom" name="lastname" required><input type="text" placeholder="Prénom" name="firstname" required><select name="position"><option value="">--Poste--</option><option value="Administrateur">Administrateur</option><option value="Technicien">Technicien</option><option value="Chef d&#39;équipe">Chef d&#39;équipe</option><option value="Développeur">Développeur</option><option value="CTO">CTO</option><option value="CEO">CEO</option></select></div><button type="submit">S&#39;INSCRIRE</button>',2),wt=[vt];function Pt(e,t,o,s,i,r){return(0,n.wg)(),(0,n.iD)("form",{class:"login-form",onSubmit:t[0]||(t[0]=e=>r.submitRegister(e))},wt,32)}let It=new z;var yt={methods:{submitRegister(e){e.preventDefault();const t=new FormData(e.target),o={email:t.get("email"),password:t.get("password"),lastname:t.get("lastname"),firstname:t.get("firstname"),position:t.get("position")};It.addUser(o),alert("Inscription réussie !"),this.$emit("new-user",o.email)}}};const Ct=(0,r.Z)(yt,[["render",Pt]]);var _t=Ct,kt={components:{LoginForm:ft,RegisterForm:_t},data(){return{registerMode:"",email:""}},mounted(){localStorage.clear()},methods:{handleMode(e,t){!0===e?this.registerMode="registerMode":(this.registerMode="",this.email=t)}}};const bt=(0,r.Z)(kt,[["render",at]]);var Dt=bt;const Ut={class:"page-body"},St=(0,n._)("h2",{class:"history"},"Historique des posts",-1);function xt(e,t,o,s,i,r){const a=(0,n.up)("NavBar"),l=(0,n.up)("ProfileInfo"),c=(0,n.up)("PostComponent");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(a),(0,n._)("div",Ut,[(0,n.Wm)(l,{userId:r.getUserId(),user:this.user,onProfileEdited:t[0]||(t[0]=e=>r.updateProfile())},null,8,["userId","user"]),St,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.xPosts,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.id,class:"post",id:"PostsList"},[(0,n.Wm)(c,{post:e},null,8,["post"])])))),128))])],64)}o(7686),o(4506);const $t={class:"profile-block"},jt={class:"profile-image",enctype:"multipart/form-data"},Lt={class:"edit-layer"},Nt={for:"file-input",class:"input-label"},Mt=["src"],Ot={class:"profile-data"},At={class:"profile-contact"},Et=(0,n._)("b",null,"Contact : ",-1),Tt=["href"],Wt=(0,n.Uk)("Éditer mon profil ");function Zt(e,t,o,s,i,r){const a=(0,n.up)("upload-icon"),l=(0,n.up)("EditProfileForm"),c=(0,n.up)("edit-icon");return(0,n.wg)(),(0,n.iD)("div",$t,[(0,n._)("form",jt,[(0,n._)("div",Lt,[(0,n.Wm)(a)]),(0,n._)("label",Nt,[(0,n._)("img",{src:r.setAvatarPath()},null,8,Mt)]),(0,n._)("input",{type:"file",class:"uploadProfilePicture",id:"file-input",accept:"image/*",onChange:t[0]||(t[0]=e=>r.uploadProfilePicture(e)),name:"file-input"},null,32)]),(0,n._)("div",Ot,[(0,n._)("div",{class:(0,Y.C_)(["profile-content",{editMode:i.editMode}])},[(0,n._)("h1",null,(0,Y.zw)(this.user.firstname)+" "+(0,Y.zw)(this.user.lastname),1),(0,n._)("h2",null,(0,Y.zw)(this.user.position),1),(0,n._)("p",At,[Et,(0,n._)("a",{href:r.setEmail(this.user.email)},(0,Y.zw)(this.user.email),9,Tt)])],2),(0,n.Wm)(l,{user:this.user,editMode:this.editMode,onProfileEdited:r.updateProfile},null,8,["user","editMode","onProfileEdited"]),this.localUser==this.user.id?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,Y.C_)(["profile-button edit switch",i.editMode]),onClick:t[1]||(t[1]=e=>r.editProfile())},[(0,n.Wm)(c),Wt],2)):(0,n.kq)("",!0)])])}const zt={class:"form-names"},Bt=["value"],Ft=["value"],qt=["value"],Rt=["value"],Jt=["value"],Ht={class:"profile-actions"},Yt=(0,n.Uk)(" Supprimer mon compte "),Kt={type:"submit",class:"profile-button edit confirm"},Vt=(0,n.Uk)("Valider les modifications ");function Xt(e,t,o,s,i,r){const a=(0,n.up)("delete-icon"),l=(0,n.up)("edit-icon");return(0,n.wg)(),(0,n.iD)("form",{class:(0,Y.C_)(["edit-form",{editMode:o.editMode}]),onSubmit:t[1]||(t[1]=e=>r.sendEditedProfile(e))},[(0,n._)("div",zt,[(0,n._)("input",{type:"text",value:this.user.firstname,name:"firstname",placeholder:"Prénom"},null,8,Bt),(0,n._)("input",{type:"text",value:this.user.lastname,name:"lastname",placeholder:"Nom"},null,8,Ft)]),(0,n._)("select",{class:"select",name:"position",value:this.user.position,label:"position"},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.options,(e=>((0,n.wg)(),(0,n.iD)("option",{value:e.value,key:e.value},(0,Y.zw)(e.text),9,Rt)))),128))],8,qt),(0,n._)("input",{type:"email",value:this.user.email,name:"email",required:"",placeholder:"E-mail"},null,8,Jt),(0,n._)("div",Ht,[(0,n._)("div",{class:(0,Y.C_)(["profile-button delete",o.editMode]),onClick:t[0]||(t[0]=e=>r.deleteProfile())},[(0,n.Wm)(a),Yt],2),(0,n._)("button",Kt,[(0,n.Wm)(l),Vt])])],34)}let Gt=new z;var Qt={components:{deleteIcon:ve.Z},props:{user:Object,editMode:Boolean},data(){return{options:[{text:"Administrateur",value:"Administrateur"},{text:"Technicien",value:"Technicien"},{text:"Chef d'équipe",value:"Chef d'équipe"},{text:"Développeur",value:"Développeur"},{text:"CTO",value:"CTO"},{text:"CEO",value:"CEO"}]}},computed:{items(){return this.options.filter((e=>e.text!==this.user.position))}},methods:{sendEditedProfile(e){e.preventDefault();const t=new FormData(e.target),o={firstname:t.get("firstname"),lastname:t.get("lastname"),position:t.get("position"),email:t.get("email"),userId:this.user.id};Gt.editProfile(o),this.$emit("profile-edited")},deleteProfile(){let e={userId:this.user.id};Gt.deleteProfile(e),ho.push("/login")}}};const eo=(0,r.Z)(Qt,[["render",Xt]]);var to=eo,oo=o(2145);let so=new z;var no={components:{EditProfileForm:to,editIcon:fe.Z,uploadIcon:oo.Z},props:{userId:Number,user:Object},data(){return{path:"http://localhost:3000",editMode:!1,localUser:localStorage.getItem("userId")}},methods:{editProfile(){this.editMode=!this.editMode},uploadProfilePicture(e){const t=e.target.files[0];so.updateProfilePicture(t,parseInt(this.userId)),this.updateProfile()},setAvatarPath(){let e=`${this.path}/images/${this.user.avatar??"undefined.png"}`;return e},setEmail(e){return`mailto:${e}`},updateProfile(){this.emit("profile-edited")}}};const io=(0,r.Z)(no,[["render",Zt]]);var ro=io;let ao=new z;var lo={components:{NavBar:U,ProfileInfo:ro,PostComponent:Ce},data(){return{xPosts:[],user:{},userId:0}},async mounted(){this.loadUserPosts(this.getUserId()),this.userId=this.getUserId,this.user=await this.getUserData(this.getUserId())},methods:{getUserId(){let e=window.location.href.split("/"),t=e.at(-1);return t},async getUserData(e){let t=await ao.getUserData(e);this.user=t[0]},async loadUserPosts(e){this.xPosts=await ao.getUserPosts(e)},updateProfile(){this.refreshUserData(this.getUserId())},async refreshUserData(e){let t=await ao.getUserData(e);this.user=t[0]}}};const co=(0,r.Z)(lo,[["render",xt]]);var uo=co;const mo=[{path:"/",redirect:{name:"login"}},{path:"/home",name:"home",component:tt},{path:"/login",name:"login",component:Dt},{path:"/profile/:id",name:"profile",component:uo}],po=(0,d.p7)({history:(0,d.PO)(),routes:mo});var ho=po;(0,s.ri)(c).use(ho).mount("#app")}},t={};function o(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,s,n,i){if(!s){var r=1/0;for(d=0;d<e.length;d++){s=e[d][0],n=e[d][1],i=e[d][2];for(var a=!0,l=0;l<s.length;l++)(!1&i||r>=i)&&Object.keys(o.O).every((function(e){return o.O[e](s[l])}))?s.splice(l--,1):(a=!1,i<r&&(r=i));if(a){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[s,n,i]}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.p="/"}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,i,r=s[0],a=s[1],l=s[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(l)var d=l(o)}for(t&&t(s);c<r.length;c++)i=r[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(d)},s=self["webpackChunkgroupomania"]=self["webpackChunkgroupomania"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[998],(function(){return o(5178)}));s=o.O(s)})();
//# sourceMappingURL=app.c38d2b0d.js.map